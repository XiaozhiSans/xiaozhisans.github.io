/**
 * 冬季雪花效果 @XiaozhiSans
 * 修改自原文件 https://eco.krt.moe/posts/effect-snow/
 */
(()=>{document.querySelector("head").insertAdjacentHTML("beforeend","<style>#snow{position:fixed;top:0;left:0;width:100%;height:100%;z-index:99999;pointer-events:none;background:rgba(225,225,225,.05)}</style>"),document.body.insertAdjacentHTML("beforeend",'<canvas id="snow"></canvas>');let e;const t=new Date;e=10===t.getMonth()||11===t.getMonth()||0===t.getMonth();const n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};window.requestAnimationFrame=n;const i=document.getElementById("snow"),o=i.getContext("2d");let a=-100,d=-100,s=[];i.width=window.innerWidth,i.height=window.innerHeight;const h=()=>{if(!e)return;o.clearRect(0,0,i.width,i.height);for(let e=0;e<100;e++){let t=s[e];const n=a,h=d,l=t.x,w=t.y,m=Math.sqrt((n-l)*(n-l)+(h-w)*(h-w));if(m<150){const e=(n-l)/m,i=(h-w)/m,o=150/(m*m)/2;t.velX-=o*e,t.velY-=o*i}else t.velX*=.98,t.velY<t.speed&&t.speed-t.velY>.01&&(t.velY+=.01*(t.speed-t.velY)),t.velX+=Math.cos(t.step+=.05)*t.stepSize;o.fillStyle="rgba(255, 255, 255, "+t.opacity+")",t.y+=t.velY,t.x+=t.velX,(t.y>=i.height||t.y<=0)&&r(t),(t.x>=i.width||t.x<=0)&&r(t),o.beginPath(),o.arc(t.x,t.y,t.size,0,2*Math.PI),o.fill()}n(h)},r=e=>{e.x=Math.floor(Math.random()*i.width),e.y=0,e.size=3*Math.random()+2,e.speed=1*Math.random()+.5,e.velY=e.speed,e.velX=0,e.opacity=.5*Math.random()+.3};document.addEventListener("mousemove",(e=>{a=e.clientX,d=e.clientY})),window.addEventListener("resize",(()=>{i.width=window.innerWidth,i.height=window.innerHeight})),(()=>{for(let e=0;e<100;e++){const e=Math.floor(Math.random()*i.width),t=Math.floor(Math.random()*i.height),n=3*Math.random()+2,o=1*Math.random()+.5,a=.5*Math.random()+.3;s.push({speed:o,velX:0,velY:o,x:e,y:t,size:n,stepSize:Math.random()/30*.5,step:0,angle:180,opacity:a})}h()})()})();